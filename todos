todos:
mat specific compilation
cgray for mpi kernels
dynamic subset for mpi kernels as well?
scaling requires fix

valgrind memcheck - lead detection