todos:
dynamic subset for mpi kernels as well?
cgray for mpi kernels
decomposition for mpi kernels
scaling requires fix